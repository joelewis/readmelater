# Migration `20200725193850`

This migration has been generated by Joe B. Lewis at 7/25/2020, 7:38:50 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
PRAGMA foreign_keys=OFF;

CREATE TABLE "Link" (
"createdAt" DATE NOT NULL DEFAULT CURRENT_TIMESTAMP,
"href" TEXT NOT NULL,
"id" INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT,
"notify" BOOLEAN NOT NULL DEFAULT true,
"readingTime" TEXT ,
"timeout" TEXT ,
"userId" INTEGER NOT NULL,FOREIGN KEY ("userId") REFERENCES "User"("id") ON DELETE CASCADE ON UPDATE CASCADE)

CREATE TABLE "Tag" (
"id" INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT,
"notify" BOOLEAN NOT NULL DEFAULT true,
"tag" TEXT NOT NULL,
"userId" INTEGER NOT NULL,FOREIGN KEY ("userId") REFERENCES "User"("id") ON DELETE CASCADE ON UPDATE CASCADE)

CREATE TABLE "User" (
"createdAt" DATE NOT NULL DEFAULT CURRENT_TIMESTAMP,
"email" TEXT NOT NULL,
"id" INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT,
"name" TEXT ,
"notify" BOOLEAN NOT NULL DEFAULT true)

CREATE TABLE "_LinkToTag" (
"A" INTEGER NOT NULL,
"B" INTEGER NOT NULL,FOREIGN KEY ("A") REFERENCES "Link"("id") ON DELETE CASCADE ON UPDATE CASCADE,
FOREIGN KEY ("B") REFERENCES "Tag"("id") ON DELETE CASCADE ON UPDATE CASCADE)

CREATE UNIQUE INDEX "Link.userId_href" ON "Link"("userId","href")

CREATE UNIQUE INDEX "Tag.userId_tag" ON "Tag"("userId","tag")

CREATE UNIQUE INDEX "User.email" ON "User"("email")

CREATE UNIQUE INDEX "_LinkToTag_AB_unique" ON "_LinkToTag"("A","B")

CREATE  INDEX "_LinkToTag_B_index" ON "_LinkToTag"("B")

PRAGMA foreign_key_check;

PRAGMA foreign_keys=ON;
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20200725185750..20200725193850
--- datamodel.dml
+++ datamodel.dml
@@ -2,10 +2,10 @@
 // learn more about it in the docs: https://pris.ly/d/prisma-schema
 datasource sqlite {
   provider = "sqlite"
-  url = "***"
-  // url = "***"
+  url = "***"
+  // url = "***"
 }
 generator client {
   provider = "prisma-client-js"
@@ -18,9 +18,9 @@
   href      String
   readingTime String?
   user      User     @relation(fields: [userId], references: [id])
   userId    Int
-  tags      Tag[]
+  tags      Tag[]    @relation(references: [id])
   timeout   String?
   notify    Boolean  @default(true)
   @@unique([userId, href])
@@ -31,8 +31,9 @@
   tag       String
   user      User     @relation(fields: [userId], references: [id])
   notify    Boolean  @default(true)
   userId    Int
+  posts     Link[]   @relation(references: [id])
   @@unique([userId, tag])
 }
```


